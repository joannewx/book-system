<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿ</title>
    <!-- å¼•å…¥SheetJSåº“ -->
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        /* ç™»å½•é¡µé¢æ ·å¼ */
        .login-container {
            width: 100%;
            max-width: 400px;
        }
        
        .login-box {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            text-align: center;
        }
        
        .login-title {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .login-subtitle {
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 16px;
        }
        
        .login-icon {
            font-size: 60px;
            color: #3498db;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .login-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(46, 204, 113, 0.3);
        }
        
        .register-link {
            margin-top: 20px;
            color: #7f8c8d;
        }
        
        .register-link a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
        }
        
        .register-link a:hover {
            text-decoration: underline;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }
        
        /* ä¸»ç³»ç»Ÿå®¹å™¨ */
        .system-container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
            display: none;
        }
        
        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .top-navbar {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 0 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }
        
        .navbar-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .system-title {
            font-size: 22px;
            font-weight: 600;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        
        .logout-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* ä¸»ä½“å¸ƒå±€ */
        .main-content {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 800px;
        }
        
        /* ä¾§è¾¹æ  */
        .sidebar {
            background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 25px;
        }
        
        .nav-section {
            margin-bottom: 30px;
        }
        
        .nav-section h3 {
            color: #3498db;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(52, 152, 219, 0.3);
            font-size: 16px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #ecf0f1;
        }
        
        .nav-item:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: translateX(5px);
        }
        
        .nav-item.active {
            background: #3498db;
            color: white;
            font-weight: 500;
        }
        
        .nav-icon {
            font-size: 18px;
            width: 24px;
            text-align: center;
        }
        
        /* å†…å®¹åŒºåŸŸ */
        .content-area {
            padding: 30px;
            background: #f8f9fa;
            overflow-y: auto;
            max-height: 800px;
        }
        
        /* ç»Ÿè®¡æ•°æ®æ  */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #2ecc71;
        }
        
        .stat-label {
            font-size: 14px;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        /* åŠŸèƒ½å¡ç‰‡ */
        .function-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: #3498db;
        }
        
        .card-icon {
            font-size: 40px;
            margin-bottom: 15px;
            color: #3498db;
        }
        
        .card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .card p {
            color: #7f8c8d;
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* è¡¨æ ¼å®¹å™¨ */
        .table-container {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            margin-top: 20px;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .table-title {
            color: #2c3e50;
            font-size: 20px;
            font-weight: 600;
        }
        
        .table-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }
        
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12 0%, #d68910 100%);
            color: white;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.3);
        }
        
        /* å­¦ç”Ÿè¡¨æ ¼ */
        .students-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .students-table th {
            background: #3498db;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        .students-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        
        .students-table tr:hover {
            background-color: #f5f9ff;
        }
        
        .students-table tr.selected {
            background-color: #e8f4fc;
        }
        
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-active {
            background: #d4edda;
            color: #155724;
        }
        
        .status-graduate {
            background: #f8d7da;
            color: #721c24;
        }
        
        /* æœç´¢æ¡† */
        .search-box {
            position: relative;
            margin-bottom: 20px;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 20px 12px 45px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #7f8c8d;
            font-size: 18px;
        }
        
        /* é€‰æ‹©æ§åˆ¶ */
        .select-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid #eaeaea;
        }
        
        .select-all-checkbox {
            transform: scale(1.2);
            margin-right: 8px;
            cursor: pointer;
        }
        
        /* åˆ†é¡µ */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .page-btn {
            padding: 8px 15px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .page-btn:hover {
            background: #f5f5f5;
        }
        
        .page-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        
        .page-info {
            color: #7f8c8d;
            font-size: 14px;
        }
        
        /* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */
        .file-upload-area {
            border: 3px dashed #3498db;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
            background: #f8f9fa;
        }
        
        .file-upload-area:hover {
            background: #e8f4fc;
            border-color: #2980b9;
        }
        
        .upload-icon {
            font-size: 48px;
            color: #3498db;
            margin-bottom: 15px;
        }
        
        .upload-text {
            font-size: 16px;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .upload-hint {
            font-size: 14px;
            color: #7f8c8d;
        }
        
        /* ç©ºçŠ¶æ€ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #95a5a6;
        }
        
        .empty-icon {
            font-size: 60px;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        .empty-text {
            font-size: 18px;
            color: #7f8c8d;
        }
        
        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-header {
            padding: 25px 30px;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 22px;
            font-weight: 600;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .modal-footer {
            padding: 20px 30px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }
        
        /* æ“ä½œæŒ‰é’®ç»„ */
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        
        .action-btn.edit {
            background: #3498db;
            color: white;
        }
        
        .action-btn.delete {
            background: #e74c3c;
            color: white;
        }
        
        .action-btn.view {
            background: #2ecc71;
            color: white;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 250px 1fr;
            }
            
            .stats-bar {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
            
            .stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .function-cards {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .stats-bar {
                grid-template-columns: 1fr;
            }
            
            .function-cards {
                grid-template-columns: 1fr;
            }
            
            .table-actions {
                width: 100%;
            }
            
            .table-actions .btn {
                flex: 1;
                justify-content: center;
            }
            
            .top-navbar {
                padding: 0 15px;
            }
            
            .login-box {
                padding: 30px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- ç™»å½•é¡µé¢ -->
    <div id="loginPage" class="login-container">
        <div class="login-box">
            <div class="login-icon">ğŸ“</div>
            <h1 class="login-title">å­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿ</h1>
            <p class="login-subtitle">æ¬¢è¿ç™»å½•ï¼Œè¯·ä½¿ç”¨æ‚¨çš„è´¦å·å¯†ç </p>
            
            <div id="loginError" class="error-message"></div>
            
            <form id="loginForm" onsubmit="login(event)">
                <div class="form-group">
                    <label for="username">ç”¨æˆ·å</label>
                    <input type="text" id="username" class="form-control" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" required>
                </div>
                
                <div class="form-group">
                    <label for="password">å¯†ç </label>
                    <input type="password" id="password" class="form-control" placeholder="è¯·è¾“å…¥å¯†ç " required>
                </div>
                
                <button type="submit" class="login-btn">ğŸ” ç™»å½•ç³»ç»Ÿ</button>
            </form>
            
            <div class="register-link">
                è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ<a href="javascript:void(0)" onclick="showRegister()">ç«‹å³æ³¨å†Œ</a>
            </div>
        </div>
    </div>
    
    <!-- æ³¨å†Œé¡µé¢ -->
    <div id="registerPage" class="login-container" style="display: none;">
        <div class="login-box">
            <div class="login-icon">ğŸ“</div>
            <h1 class="login-title">ç”¨æˆ·æ³¨å†Œ</h1>
            <p class="login-subtitle">åˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦å·</p>
            
            <div id="registerError" class="error-message"></div>
            
            <form id="registerForm" onsubmit="register(event)">
                <div class="form-group">
                    <label for="regUsername">ç”¨æˆ·å</label>
                    <input type="text" id="regUsername" class="form-control" placeholder="è¯·è¾“å…¥ç”¨æˆ·åï¼ˆè‡³å°‘3ä½ï¼‰" required>
                </div>
                
                <div class="form-group">
                    <label for="regPassword">å¯†ç </label>
                    <input type="password" id="regPassword" class="form-control" placeholder="è¯·è¾“å…¥å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰" required>
                </div>
                
                <div class="form-group">
                    <label for="confirmPassword">ç¡®è®¤å¯†ç </label>
                    <input type="password" id="confirmPassword" class="form-control" placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç " required>
                </div>
                
                <div class="form-group">
                    <label for="regRealName">çœŸå®å§“å</label>
                    <input type="text" id="regRealName" class="form-control" placeholder="è¯·è¾“å…¥æ‚¨çš„çœŸå®å§“å" required>
                </div>
                
                <div class="form-group">
                    <label for="regEmail">ç”µå­é‚®ç®±</label>
                    <input type="email" id="regEmail" class="form-control" placeholder="è¯·è¾“å…¥ç”µå­é‚®ç®±" required>
                </div>
                
                <button type="submit" class="login-btn">âœ… æ³¨å†Œè´¦å·</button>
            </form>
            
            <div class="register-link">
                å·²æœ‰è´¦å·ï¼Ÿ<a href="javascript:void(0)" onclick="showLogin()">è¿”å›ç™»å½•</a>
            </div>
        </div>
    </div>
    
    <!-- ä¸»ç³»ç»Ÿé¡µé¢ -->
    <div id="systemPage" class="system-container">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <div class="top-navbar">
            <div class="navbar-left">
                <div class="user-avatar" id="userAvatar">ğŸ‘¤</div>
                <div>
                    <div class="system-title">å­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿ</div>
                    <div style="font-size: 12px; color: rgba(255,255,255,0.8);">
                        æ¬¢è¿æ‚¨ï¼Œ<span id="currentUserName">ç®¡ç†å‘˜</span>
                    </div>
                </div>
            </div>
            
            <div class="user-info">
                <button class="logout-btn" onclick="logout()">
                    <span>ğŸšª</span>
                    <span>é€€å‡ºç™»å½•</span>
                </button>
            </div>
        </div>
        
        <!-- ä¸»ä½“å†…å®¹ -->
        <div class="main-content">
            <!-- ä¾§è¾¹æ  -->
            <div class="sidebar">
                <div class="nav-section">
                    <h3>ğŸ“‹ ä¸»è¦åŠŸèƒ½</h3>
                    <div class="nav-item active" onclick="showDashboard()">
                        <div class="nav-icon">ğŸ“Š</div>
                        <span>æ•°æ®çœ‹æ¿</span>
                    </div>
                    <div class="nav-item" onclick="showAllStudents()">
                        <div class="nav-icon">ğŸ‘¥</div>
                        <span>æ‰€æœ‰å­¦ç”Ÿ</span>
                    </div>
                    <div class="nav-item" onclick="showImportSection()">
                        <div class="nav-icon">ğŸ“¥</div>
                        <span>å¯¼å…¥æ•°æ®</span>
                    </div>
                    <div class="nav-item" onclick="showExportSection()">
                        <div class="nav-icon">ğŸ“¤</div>
                        <span>å¯¼å‡ºæ•°æ®</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <h3>ğŸ”§ æ•°æ®ç®¡ç†</h3>
                    <div class="nav-item" onclick="showAddStudent()">
                        <div class="nav-icon">â•</div>
                        <span>æ·»åŠ å­¦ç”Ÿ</span>
                    </div>
                    <div class="nav-item" onclick="showBatchDelete()">
                        <div class="nav-icon">ğŸ—‘ï¸</div>
                        <span>æ‰¹é‡åˆ é™¤</span>
                    </div>
                    <div class="nav-item" onclick="showSearchSection()">
                        <div class="nav-icon">ğŸ”</div>
                        <span>æœç´¢å­¦ç”Ÿ</span>
                    </div>
                    <div class="nav-item" onclick="showStatistics()">
                        <div class="nav-icon">ğŸ“ˆ</div>
                        <span>æ•°æ®ç»Ÿè®¡</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <h3>ğŸ‘¤ ç”¨æˆ·ç®¡ç†</h3>
                    <div class="nav-item" onclick="showUserProfile()">
                        <div class="nav-icon">ğŸ‘¤</div>
                        <span>ä¸ªäººèµ„æ–™</span>
                    </div>
                    <div class="nav-item" onclick="showChangePassword()">
                        <div class="nav-icon">ğŸ”’</div>
                        <span>ä¿®æ”¹å¯†ç </span>
                    </div>
                    <div class="nav-item" onclick="manageUsers()">
                        <div class="nav-icon">ğŸ‘¥</div>
                        <span>ç”¨æˆ·ç®¡ç†</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <h3>âš™ï¸ ç³»ç»Ÿè®¾ç½®</h3>
                    <div class="nav-item" onclick="backupData()">
                        <div class="nav-icon">ğŸ’¾</div>
                        <span>æ•°æ®å¤‡ä»½</span>
                    </div>
                    <div class="nav-item" onclick="restoreData()">
                        <div class="nav-icon">ğŸ”„</div>
                        <span>æ•°æ®æ¢å¤</span>
                    </div>
                    <div class="nav-item" onclick="clearAllData()">
                        <div class="nav-icon">ğŸ—‘ï¸</div>
                        <span>æ¸…ç©ºæ•°æ®</span>
                    </div>
                </div>
            </div>
            
            <!-- å†…å®¹åŒºåŸŸ -->
            <div class="content-area">
                <!-- æ•°æ®çœ‹æ¿ -->
                <div id="dashboardContent">
                    <h2 style="color: #2c3e50; margin-bottom: 25px;">ğŸ“Š ç³»ç»ŸåŠŸèƒ½æ¦‚è§ˆ</h2>
                    
                    <!-- ç»Ÿè®¡æ•°æ® -->
                    <div class="stats-bar">
                        <div class="stat-card">
                            <div class="stat-value" id="totalStudents">0</div>
                            <div class="stat-label">å­¦ç”Ÿæ€»æ•°</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="activeStudents">0</div>
                            <div class="stat-label">åœ¨è¯»å­¦ç”Ÿ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="graduateStudents">0</div>
                            <div class="stat-label">å·²æ¯•ä¸š</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="maleStudents">0</div>
                            <div class="stat-label">ç”·ç”Ÿ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="femaleStudents">0</div>
                            <div class="stat-label">å¥³ç”Ÿ</div>
                        </div>
                    </div>
                    
                    <!-- åŠŸèƒ½å¡ç‰‡ -->
                    <div class="function-cards">
                        <div class="card" onclick="showAllStudents()">
                            <div class="card-icon">ğŸ‘¥</div>
                            <h3>æŸ¥çœ‹æ‰€æœ‰å­¦ç”Ÿ</h3>
                            <p>æµè§ˆç³»ç»Ÿä¸­çš„æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯ï¼Œæ”¯æŒæœç´¢ã€ç­›é€‰å’Œæ’åºåŠŸèƒ½ã€‚</p>
                        </div>
                        
                        <div class="card" onclick="showImportSection()">
                            <div class="card-icon">ğŸ“¥</div>
                            <h3>Excelå¯¼å…¥</h3>
                            <p>é€šè¿‡Excelæ–‡ä»¶æ‰¹é‡å¯¼å…¥å­¦ç”Ÿä¿¡æ¯ï¼Œæ”¯æŒ.xlsxã€.xlsã€.csvæ ¼å¼ã€‚</p>
                        </div>
                        
                        <div class="card" onclick="showAddStudent()">
                            <div class="card-icon">â•</div>
                            <h3>æ·»åŠ å­¦ç”Ÿ</h3>
                            <p>æ‰‹åŠ¨æ·»åŠ å•ä¸ªå­¦ç”Ÿä¿¡æ¯ï¼Œå¡«å†™è¯¦ç»†çš„å­¦ç”Ÿèµ„æ–™ã€‚</p>
                        </div>
                        
                        <div class="card" onclick="showBatchDelete()">
                            <div class="card-icon">ğŸ—‘ï¸</div>
                            <h3>æ‰¹é‡åˆ é™¤</h3>
                            <p>æ‰¹é‡é€‰æ‹©å¹¶åˆ é™¤å­¦ç”Ÿä¿¡æ¯ï¼Œæ”¯æŒå…¨é€‰å’Œæ¡ä»¶ç­›é€‰ã€‚</p>
                        </div>
                        
                        <div class="card" onclick="showExportSection()">
                            <div class="card-icon">ğŸ“¤</div>
                            <h3>å¯¼å‡ºæ•°æ®</h3>
                            <p>å°†å­¦ç”Ÿæ•°æ®å¯¼å‡ºä¸ºExcelæ–‡ä»¶ï¼Œæ–¹ä¾¿å¤‡ä»½å’Œåˆ†äº«ã€‚</p>
                        </div>
                        
                        <div class="card" onclick="showUserProfile()">
                            <div class="card-icon">ğŸ‘¤</div>
                            <h3>ä¸ªäººèµ„æ–™</h3>
                            <p>æŸ¥çœ‹å’Œä¿®æ”¹æ‚¨çš„ä¸ªäººèµ„æ–™ä¿¡æ¯ï¼Œç®¡ç†è´¦å·è®¾ç½®ã€‚</p>
                        </div>
                    </div>
                </div>
                
                <!-- å­¦ç”Ÿåˆ—è¡¨ -->
                <div id="studentsContent" class="table-container" style="display: none;">
                    <div class="table-header">
                        <div class="table-title">ğŸ‘¥ å­¦ç”Ÿä¿¡æ¯åˆ—è¡¨</div>
                        <div class="table-actions">
                            <button class="btn btn-primary" onclick="showAddStudent()">â• æ·»åŠ å­¦ç”Ÿ</button>
                            <button class="btn btn-secondary" onclick="showImportSection()">ğŸ“¥ å¯¼å…¥Excel</button>
                            <button class="btn btn-danger" onclick="showBatchDelete()">ğŸ—‘ï¸ æ‰¹é‡åˆ é™¤</button>
                            <button class="btn btn-warning" onclick="exportToExcel()">ğŸ“¤ å¯¼å‡ºExcel</button>
                        </div>
                    </div>
                    
                    <div class="search-box">
                        <input type="text" class="search-input" placeholder="ğŸ” æœç´¢å­¦ç”Ÿï¼ˆå­¦å·ã€å§“åã€ä¸“ä¸šã€ç­çº§...ï¼‰" 
                               onkeyup="searchStudents(this.value)" id="searchInput">
                        <div class="search-icon">ğŸ”</div>
                    </div>
                    
                    <div class="select-controls">
                        <input type="checkbox" id="selectAllStudents" class="select-all-checkbox" 
                               onchange="toggleSelectAllStudents(this)">
                        <label for="selectAllStudents" style="cursor: pointer; font-weight: 500;">
                            å…¨é€‰æœ¬é¡µå­¦ç”Ÿ
                        </label>
                        <span style="color: #3498db; font-weight: 600;">
                            å·²é€‰æ‹©ï¼š<span id="selectedCount">0</span> å
                        </span>
                        <button class="btn btn-danger" onclick="deleteSelectedStudents()" style="margin-left: auto;">
                            ğŸ—‘ï¸ åˆ é™¤é€‰ä¸­
                        </button>
                    </div>
                    
                    <div style="overflow-x: auto;">
                        <table class="students-table">
                            <thead>
                                <tr>
                                    <th style="width: 50px;">é€‰æ‹©</th>
                                    <th>å­¦å·</th>
                                    <th>å§“å</th>
                                    <th>æ€§åˆ«</th>
                                    <th>ç­çº§</th>
                                    <th>ä¸“ä¸š</th>
                                    <th>å­¦é™¢</th>
                                    <th>çŠ¶æ€</th>
                                    <th style="width: 150px;">æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="studentsTableBody">
                                <!-- å­¦ç”Ÿæ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="pagination">
                        <button class="page-btn" onclick="changePage(-1)">â—€ ä¸Šä¸€é¡µ</button>
                        <span class="page-info" id="pageInfo">ç¬¬ 1 é¡µ / å…± 1 é¡µ</span>
                        <button class="page-btn" onclick="changePage(1)">ä¸‹ä¸€é¡µ â–¶</button>
                    </div>
                </div>
                
                <!-- å¯¼å…¥æ•°æ®åŒºåŸŸ -->
                <div id="importContent" class="table-container" style="display: none;">
                    <div class="table-header">
                        <div class="table-title">ğŸ“¥ Excelå¯¼å…¥å­¦ç”Ÿæ•°æ®</div>
                    </div>
                    
                    <div class="file-upload-area" onclick="document.getElementById('excelFile').click()">
                        <div class="upload-icon">ğŸ“</div>
                        <div class="upload-text">ç‚¹å‡»é€‰æ‹©Excelæ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ</div>
                        <div class="upload-hint">æ”¯æŒ .xlsx, .xls, .csv æ ¼å¼ï¼Œè¯·ç¡®ä¿ç¬¬ä¸€è¡Œä¸ºè¡¨å¤´</div>
                    </div>
                    
                    <input type="file" id="excelFile" accept=".xlsx,.xls,.csv" style="display: none;" 
                           onchange="handleExcelUpload(event)">
                    
                    <div id="importPreview" style="margin-top: 30px;">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ“Š</div>
                            <div class="empty-text">è¯·ä¸Šä¼ Excelæ–‡ä»¶æŸ¥çœ‹æ•°æ®é¢„è§ˆ</div>
                        </div>
                    </div>
                    
                    <div class="modal-footer" style="margin-top: 20px; padding: 0;">
                        <button class="btn btn-primary" id="importConfirmBtn" onclick="confirmImport()" style="display: none;">
                            âœ… ç¡®è®¤å¯¼å…¥
                        </button>
                        <button class="btn btn-secondary" onclick="clearImportPreview()">
                            ğŸ—‘ï¸ æ¸…ç©ºé¢„è§ˆ
                        </button>
                    </div>
                </div>
                
                <!-- æ·»åŠ å­¦ç”ŸåŒºåŸŸ -->
                <div id="addStudentContent" class="table-container" style="display: none;">
                    <div class="table-header">
                        <div class="table-title">â• æ·»åŠ æ–°å­¦ç”Ÿ</div>
                    </div>
                    
                    <form id="addStudentForm" onsubmit="addNewStudent(event)">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                            <div class="form-group">
                                <label for="studentId">å­¦å· *</label>
                                <input type="text" id="studentId" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="name">å§“å *</label>
                                <input type="text" id="name" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="gender">æ€§åˆ«</label>
                                <select id="gender" class="form-control">
                                    <option value="ç”·">ç”·</option>
                                    <option value="å¥³">å¥³</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="className">ç­çº§</label>
                                <input type="text" id="className" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="major">ä¸“ä¸š</label>
                                <input type="text" id="major" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="college">å­¦é™¢</label>
                                <input type="text" id="college" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="email">é‚®ç®±</label>
                                <input type="email" id="email" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="birthDate">å‡ºç”Ÿæ—¥æœŸ</label>
                                <input type="date" id="birthDate" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="enrollmentDate">å…¥å­¦æ—¥æœŸ</label>
                                <input type="date" id="enrollmentDate" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="hometown">ç±è´¯</label>
                                <input type="text" id="hometown" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="ethnicity">æ°‘æ—</label>
                                <input type="text" id="ethnicity" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="politicalStatus">æ”¿æ²»é¢è²Œ</label>
                                <select id="politicalStatus" class="form-control">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="ç¾¤ä¼—">ç¾¤ä¼—</option>
                                    <option value="å…±é’å›¢å‘˜">å…±é’å›¢å‘˜</option>
                                    <option value="ä¸­å…±å…šå‘˜">ä¸­å…±å…šå‘˜</option>
                                    <option value="å…¶ä»–">å…¶ä»–</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="status">çŠ¶æ€</label>
                                <select id="status" class="form-control">
                                    <option value="åœ¨è¯»">åœ¨è¯»</option>
                                    <option value="ä¼‘å­¦">ä¼‘å­¦</option>
                                    <option value="æ¯•ä¸š">æ¯•ä¸š</option>
                                    <option value="é€€å­¦">é€€å­¦</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="modal-footer" style="margin-top: 30px; padding: 0;">
                            <button type="button" class="btn btn-secondary" onclick="showDashboard()">
                                å–æ¶ˆ
                            </button>
                            <button type="submit" class="btn btn-primary">
                                âœ… æ·»åŠ å­¦ç”Ÿ
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- ä¸ªäººèµ„æ–™åŒºåŸŸ -->
                <div id="profileContent" class="table-container" style="display: none;">
                    <div class="table-header">
                        <div class="table-title">ğŸ‘¤ ä¸ªäººèµ„æ–™</div>
                    </div>
                    
                    <div id="profileInfo" style="padding: 20px;">
                        <!-- ä¸ªäººèµ„æ–™å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                    </div>
                </div>
                
                <!-- ä¿®æ”¹å¯†ç åŒºåŸŸ -->
                <div id="changePasswordContent" class="table-container" style="display: none;">
                    <div class="table-header">
                        <div class="table-title">ğŸ”’ ä¿®æ”¹å¯†ç </div>
                    </div>
                    
                    <form id="changePasswordForm" onsubmit="changePassword(event)" style="padding: 20px;">
                        <div class="form-group">
                            <label for="currentPassword">å½“å‰å¯†ç </label>
                            <input type="password" id="currentPassword" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="newPassword">æ–°å¯†ç </label>
                            <input type="password" id="newPassword" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmNewPassword">ç¡®è®¤æ–°å¯†ç </label>
                            <input type="password" id="confirmNewPassword" class="form-control" required>
                        </div>
                        
                        <div class="modal-footer" style="margin-top: 30px; padding: 0;">
                            <button type="button" class="btn btn-secondary" onclick="showDashboard()">
                                å–æ¶ˆ
                            </button>
                            <button type="submit" class="btn btn-primary">
                                ğŸ”„ ä¿®æ”¹å¯†ç 
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- æ¨¡æ€æ¡†å®¹å™¨ -->
    <div id="modalContainer"></div>

    <script>
        // å…¨å±€å˜é‡
        let students = [];
        let users = [];
        let currentUser = null;
        let selectedStudentIds = new Set();
        let currentPage = 1;
        const pageSize = 15;
        let filteredStudents = [];
        let currentView = 'dashboard';
        
        // åˆå§‹åŒ–ç³»ç»Ÿ
        function initSystem() {
            // åˆå§‹åŒ–æ•°æ®å­˜å‚¨
            initLocalStorage();
            
            // åŠ è½½æ•°æ®
            loadUsers();
            loadStudents();
            
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            checkLoginStatus();
        }
        
        // åˆå§‹åŒ–æœ¬åœ°å­˜å‚¨
        function initLocalStorage() {
            if (!localStorage.getItem('users')) {
                // åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜è´¦å·
                const defaultUsers = [
                    {
                        id: 1,
                        username: 'admin',
                        password: 'admin123', // æ³¨æ„ï¼šå®é™…åº”ç”¨ä¸­åº”è¯¥åŠ å¯†å­˜å‚¨
                        realName: 'ç³»ç»Ÿç®¡ç†å‘˜',
                        email: 'admin@example.com',
                        role: 'admin',
                        createTime: new Date().toISOString(),
                        lastLogin: null
                    }
                ];
                localStorage.setItem('users', JSON.stringify(defaultUsers));
            }
            
            if (!localStorage.getItem('students')) {
                localStorage.setItem('students', JSON.stringify([]));
            }
        }
        
        // åŠ è½½ç”¨æˆ·æ•°æ®
        function loadUsers() {
            const data = localStorage.getItem('users');
            users = data ? JSON.parse(data) : [];
        }
        
        // åŠ è½½å­¦ç”Ÿæ•°æ®
        function loadStudents() {
            const data = localStorage.getItem('students');
            students = data ? JSON.parse(data) : [];
            filteredStudents = [...students];
            updateStatistics();
        }
        
        // ä¿å­˜å­¦ç”Ÿæ•°æ®
        function saveStudents() {
            localStorage.setItem('students', JSON.stringify(students));
            updateStatistics();
        }
        
        // ä¿å­˜ç”¨æˆ·æ•°æ®
        function saveUsers() {
            localStorage.setItem('users', JSON.stringify(users));
        }
        
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        function checkLoginStatus() {
            const loggedInUser = localStorage.getItem('loggedInUser');
            if (loggedInUser) {
                currentUser = JSON.parse(loggedInUser);
                showSystem();
            } else {
                showLogin();
            }
        }
        
        // æ˜¾ç¤ºç™»å½•é¡µé¢
        function showLogin() {
            document.getElementById('loginPage').style.display = 'block';
            document.getElementById('registerPage').style.display = 'none';
            document.getElementById('systemPage').style.display = 'none';
        }
        
        // æ˜¾ç¤ºæ³¨å†Œé¡µé¢
        function showRegister() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('registerPage').style.display = 'block';
            document.getElementById('systemPage').style.display = 'none';
        }
        
        // æ˜¾ç¤ºç³»ç»Ÿé¡µé¢
        function showSystem() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('registerPage').style.display = 'none';
            document.getElementById('systemPage').style.display = 'block';
            
            // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
            document.getElementById('currentUserName').textContent = currentUser.realName;
            document.getElementById('userAvatar').textContent = getAvatarEmoji(currentUser.realName);
            
            // æ˜¾ç¤ºçœ‹æ¿
            showDashboard();
        }
        
        // è·å–å¤´åƒemoji
        function getAvatarEmoji(name) {
            if (!name) return 'ğŸ‘¤';
            // æ ¹æ®å§“åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç”Ÿæˆemoji
            const firstChar = name.charAt(0).toLowerCase();
            const emojiMap = {
                'æ': 'ğŸ‘¨â€ğŸ’¼', 'ç‹': 'ğŸ‘¨â€ğŸ“', 'å¼ ': 'ğŸ‘¨â€ğŸ«', 'åˆ˜': 'ğŸ‘¨â€ğŸ”¬', 'é™ˆ': 'ğŸ‘¨â€ğŸ’»',
                'æ¨': 'ğŸ‘©â€ğŸ’¼', 'èµµ': 'ğŸ‘©â€ğŸ“', 'é»„': 'ğŸ‘©â€ğŸ«', 'å‘¨': 'ğŸ‘©â€ğŸ”¬', 'å´': 'ğŸ‘©â€ğŸ’»'
            };
            
            for (const [key, emoji] of Object.entries(emojiMap)) {
                if (name.includes(key)) {
                    return emoji;
                }
            }
            
            return 'ğŸ‘¤';
        }
        
        // ç™»å½•åŠŸèƒ½
        function login(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                // æ›´æ–°æœ€åç™»å½•æ—¶é—´
                user.lastLogin = new Date().toISOString();
                saveUsers();
                
                // ä¿å­˜ç™»å½•çŠ¶æ€
                currentUser = user;
                localStorage.setItem('loggedInUser', JSON.stringify(user));
                
                // æ˜¾ç¤ºç³»ç»Ÿ
                showSystem();
                
                // æ¸…ç©ºè¡¨å•
                document.getElementById('loginForm').reset();
                document.getElementById('loginError').style.display = 'none';
            } else {
                document.getElementById('loginError').textContent = 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼';
                document.getElementById('loginError').style.display = 'block';
            }
        }
        
        // æ³¨å†ŒåŠŸèƒ½
        function register(event) {
            event.preventDefault();
            
            const username = document.getElementById('regUsername').value.trim();
            const password = document.getElementById('regPassword').value.trim();
            const confirmPassword = document.getElementById('confirmPassword').value.trim();
            const realName = document.getElementById('regRealName').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            
            // éªŒè¯ç”¨æˆ·åé•¿åº¦
            if (username.length < 3) {
                showRegisterError('ç”¨æˆ·åè‡³å°‘éœ€è¦3ä¸ªå­—ç¬¦ï¼');
                return;
            }
            
            // éªŒè¯å¯†ç é•¿åº¦
            if (password.length < 6) {
                showRegisterError('å¯†ç è‡³å°‘éœ€è¦6ä¸ªå­—ç¬¦ï¼');
                return;
            }
            
            // éªŒè¯å¯†ç æ˜¯å¦ä¸€è‡´
            if (password !== confirmPassword) {
                showRegisterError('ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´ï¼');
                return;
            }
            
            // éªŒè¯ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
            if (users.some(u => u.username === username)) {
                showRegisterError('ç”¨æˆ·åå·²å­˜åœ¨ï¼Œè¯·ä½¿ç”¨å…¶ä»–ç”¨æˆ·åï¼');
                return;
            }
            
            // éªŒè¯é‚®ç®±æ ¼å¼
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showRegisterError('è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€ï¼');
                return;
            }
            
            // åˆ›å»ºæ–°ç”¨æˆ·
            const newUser = {
                id: users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1,
                username: username,
                password: password,
                realName: realName,
                email: email,
                role: 'user', // é»˜è®¤ç”¨æˆ·è§’è‰²
                createTime: new Date().toISOString(),
                lastLogin: null
            };
            
            users.push(newUser);
            saveUsers();
            
            alert('æ³¨å†ŒæˆåŠŸï¼è¯·ä½¿ç”¨æ–°è´¦å·ç™»å½•ã€‚');
            showLogin();
        }
        
        // æ˜¾ç¤ºæ³¨å†Œé”™è¯¯
        function showRegisterError(message) {
            const errorDiv = document.getElementById('registerError');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }
        
        // é€€å‡ºç™»å½•
        function logout() {
            if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                localStorage.removeItem('loggedInUser');
                currentUser = null;
                showLogin();
            }
        }
        
        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStatistics() {
            const total = students.length;
            const active = students.filter(s => s.status === 'åœ¨è¯»').length;
            const graduate = students.filter(s => s.status === 'æ¯•ä¸š').length;
            const male = students.filter(s => s.gender === 'ç”·').length;
            const female = students.filter(s => s.gender === 'å¥³').length;
            
            document.getElementById('totalStudents').textContent = total;
            document.getElementById('activeStudents').textContent = active;
            document.getElementById('graduateStudents').textContent = graduate;
            document.getElementById('maleStudents').textContent = male;
            document.getElementById('femaleStudents').textContent = female;
        }
        
        // æ˜¾ç¤ºé¡µé¢
        function showPage(pageId) {
            document.querySelectorAll('.content-area > div').forEach(div => {
                div.style.display = 'none';
            });
            document.getElementById(pageId).style.display = 'block';
        }
        
        // æ˜¾ç¤ºæ•°æ®çœ‹æ¿
        function showDashboard() {
            currentView = 'dashboard';
            showPage('dashboardContent');
            updateNav('dashboard');
            updateStatistics();
        }
        
        // æ˜¾ç¤ºæ‰€æœ‰å­¦ç”Ÿ
        function showAllStudents() {
            currentView = 'students';
            showPage('studentsContent');
            updateNav('students');
            updateStudentsTable();
        }
        
        // æ˜¾ç¤ºå¯¼å…¥åŒºåŸŸ
        function showImportSection() {
            currentView = 'import';
            showPage('importContent');
            updateNav('import');
        }
        
        // æ˜¾ç¤ºæ·»åŠ å­¦ç”Ÿ
        function showAddStudent() {
            currentView = 'addStudent';
            showPage('addStudentContent');
            updateNav('addStudent');
        }
        
        // æ˜¾ç¤ºä¸ªäººèµ„æ–™
        function showUserProfile() {
            currentView = 'profile';
            showPage('profileContent');
            updateNav('profile');
            
            const profileInfo = document.getElementById('profileInfo');
            profileInfo.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin-bottom: 20px;">
                    <div style="text-align: center;">
                        <div style="font-size: 80px; margin-bottom: 20px;">${getAvatarEmoji(currentUser.realName)}</div>
                        <button class="btn btn-secondary" style="width: 100%;">æ›´æ¢å¤´åƒ</button>
                    </div>
                    
                    <div>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                            <div class="form-group">
                                <label>ç”¨æˆ·å</label>
                                <div style="padding: 10px; background: #f8f9fa; border-radius: 6px; font-weight: 500;">
                                    ${currentUser.username}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>è§’è‰²</label>
                                <div style="padding: 10px; background: #f8f9fa; border-radius: 6px; font-weight: 500;">
                                    ${currentUser.role === 'admin' ? 'ç³»ç»Ÿç®¡ç†å‘˜' : 'æ™®é€šç”¨æˆ·'}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>çœŸå®å§“å</label>
                                <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                    ${currentUser.realName}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>ç”µå­é‚®ç®±</label>
                                <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                    ${currentUser.email}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>è´¦å·åˆ›å»ºæ—¶é—´</label>
                                <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                    ${new Date(currentUser.createTime).toLocaleString()}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>æœ€åç™»å½•æ—¶é—´</label>
                                <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                    ${currentUser.lastLogin ? new Date(currentUser.lastLogin).toLocaleString() : 'ä»æœªç™»å½•'}
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px; display: flex; gap: 15px;">
                            <button class="btn btn-primary" onclick="showChangePassword()">
                                ğŸ”’ ä¿®æ”¹å¯†ç 
                            </button>
                            <button class="btn btn-secondary" onclick="editProfile()">
                                âœï¸ ç¼–è¾‘èµ„æ–™
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // æ˜¾ç¤ºä¿®æ”¹å¯†ç 
        function showChangePassword() {
            currentView = 'changePassword';
            showPage('changePasswordContent');
            updateNav('changePassword');
        }
        
        // æ›´æ–°å¯¼èˆªé«˜äº®
        function updateNav(activeItem) {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // æ ¹æ®å½“å‰è§†å›¾é«˜äº®å¯¹åº”çš„å¯¼èˆªé¡¹
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                if (item.textContent.includes(activeItem) || 
                    (activeItem === 'dashboard' && item.textContent.includes('æ•°æ®çœ‹æ¿'))) {
                    item.classList.add('active');
                }
            });
        }
        
        // ä¿®æ”¹å¯†ç åŠŸèƒ½
        function changePassword(event) {
            event.preventDefault();
            
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmNewPassword = document.getElementById('confirmNewPassword').value;
            
            // éªŒè¯å½“å‰å¯†ç 
            if (currentPassword !== currentUser.password) {
                alert('å½“å‰å¯†ç é”™è¯¯ï¼');
                return;
            }
            
            // éªŒè¯æ–°å¯†ç é•¿åº¦
            if (newPassword.length < 6) {
                alert('æ–°å¯†ç è‡³å°‘éœ€è¦6ä¸ªå­—ç¬¦ï¼');
                return;
            }
            
            // éªŒè¯æ–°å¯†ç æ˜¯å¦ä¸€è‡´
            if (newPassword !== confirmNewPassword) {
                alert('ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´ï¼');
                return;
            }
            
            // æ›´æ–°å¯†ç 
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex].password = newPassword;
                currentUser.password = newPassword;
                saveUsers();
                localStorage.setItem('loggedInUser', JSON.stringify(currentUser));
                
                // æ¸…ç©ºè¡¨å•
                document.getElementById('changePasswordForm').reset();
                
                alert('å¯†ç ä¿®æ”¹æˆåŠŸï¼');
                showUserProfile();
            }
        }
        
        // ç¼–è¾‘ä¸ªäººèµ„æ–™
        function editProfile() {
            const modalHtml = `
                <div class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <div class="modal-title">âœï¸ ç¼–è¾‘ä¸ªäººèµ„æ–™</div>
                            <button class="modal-close" onclick="closeModal()">Ã—</button>
                        </div>
                        <div class="modal-body">
                            <form id="editProfileForm" onsubmit="updateProfile(event)">
                                <div class="form-group">
                                    <label for="editRealName">çœŸå®å§“å</label>
                                    <input type="text" id="editRealName" class="form-control" value="${currentUser.realName}" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="editEmail">ç”µå­é‚®ç®±</label>
                                    <input type="email" id="editEmail" class="form-control" value="${currentUser.email}" required>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                            <button class="btn btn-primary" onclick="updateProfile()">ä¿å­˜ä¿®æ”¹</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('modalContainer').innerHTML = modalHtml;
            document.querySelector('.modal').style.display = 'flex';
        }
        
        // æ›´æ–°ä¸ªäººèµ„æ–™
        function updateProfile(event) {
            if (event) event.preventDefault();
            
            const realName = document.getElementById('editRealName').value.trim();
            const email = document.getElementById('editEmail').value.trim();
            
            // éªŒè¯é‚®ç®±æ ¼å¼
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€ï¼');
                return;
            }
            
            // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex].realName = realName;
                users[userIndex].email = email;
                currentUser.realName = realName;
                currentUser.email = email;
                saveUsers();
                localStorage.setItem('loggedInUser', JSON.stringify(currentUser));
                
                // æ›´æ–°é¡µé¢æ˜¾ç¤º
                document.getElementById('currentUserName').textContent = realName;
                document.getElementById('userAvatar').textContent = getAvatarEmoji(realName);
                
                closeModal();
                showUserProfile();
                alert('ä¸ªäººèµ„æ–™æ›´æ–°æˆåŠŸï¼');
            }
        }
        
        // å¤„ç†Excelä¸Šä¼ 
        function handleExcelUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (!file.name.match(/\.(xlsx|xls|csv)$/i)) {
                alert('è¯·ä¸Šä¼ Excelæ–‡ä»¶ (.xlsx, .xls, .csv)!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = e.target.result;
                    const workbook = XLSX.read(data, { type: 'binary' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                    
                    if (jsonData.length === 0) {
                        alert('Excelæ–‡ä»¶ä¸­æ²¡æœ‰æ•°æ®ï¼');
                        return;
                    }
                    
                    showImportPreview(jsonData);
                } catch (error) {
                    alert('è¯»å–Excelæ–‡ä»¶å¤±è´¥ï¼š' + error.message);
                }
            };
            reader.readAsBinaryString(file);
        }
        
        // æ˜¾ç¤ºå¯¼å…¥é¢„è§ˆ
        function showImportPreview(data) {
            const previewContainer = document.getElementById('importPreview');
            
            if (data.length === 0) {
                previewContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“Š</div>
                        <div class="empty-text">Excelæ–‡ä»¶ä¸­æ²¡æœ‰æ•°æ®</div>
                    </div>
                `;
                return;
            }
            
            let html = `
                <h3 style="color: #2c3e50; margin-bottom: 20px;">ğŸ“‹ æ•°æ®é¢„è§ˆ (å…± ${data.length} æ¡)</h3>
                <div style="overflow-x: auto;">
                    <table class="students-table">
                        <thead>
                            <tr>
            `;
            
            // è¡¨å¤´
            const headers = Object.keys(data[0] || {});
            headers.forEach(header => {
                html += `<th>${header}</th>`;
            });
            
            html += `
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            // æ•°æ®è¡Œï¼ˆæœ€å¤šæ˜¾ç¤º10è¡Œï¼‰
            const previewRows = Math.min(data.length, 10);
            for (let i = 0; i < previewRows; i++) {
                html += '<tr>';
                headers.forEach(header => {
                    let value = data[i][header];
                    value = value !== undefined && value !== null ? value.toString() : '';
                    if (value.length > 50) value = value.substring(0, 47) + '...';
                    html += `<td title="${value}">${value}</td>`;
                });
                html += '</tr>';
            }
            
            html += `
                        </tbody>
                    </table>
                </div>
            `;
            
            if (data.length > 10) {
                html += `<div style="text-align: center; margin-top: 10px; color: #7f8c8d;">
                    åªæ˜¾ç¤ºå‰10æ¡è®°å½•ï¼Œå…±æœ‰${data.length}æ¡è®°å½•
                </div>`;
            }
            
            previewContainer.innerHTML = html;
            
            // å­˜å‚¨å¯¼å…¥æ•°æ®
            window.importData = data;
            
            // æ˜¾ç¤ºç¡®è®¤æŒ‰é’®
            document.getElementById('importConfirmBtn').style.display = 'inline-block';
        }
        
        // ç¡®è®¤å¯¼å…¥
        function confirmImport() {
            if (!window.importData || window.importData.length === 0) {
                alert('æ²¡æœ‰å¯å¯¼å…¥çš„æ•°æ®ï¼');
                return;
            }
            
            const existingIds = new Set(students.map(s => s.studentId));
            let successCount = 0;
            let skipCount = 0;
            let errorCount = 0;
            
            // è·å–æœ€å¤§ID
            let maxId = students.length > 0 ? Math.max(...students.map(s => s.id)) : 0;
            
            window.importData.forEach((item, index) => {
                try {
                    const studentId = item.å­¦å· || item.studentId || item['å­¦å·'] || item['Student ID'] || '';
                    const name = item.å§“å || item.name || item['å§“å'] || item['Name'] || '';
                    
                    if (!studentId || !name) {
                        console.warn(`ç¬¬${index + 1}è¡Œï¼šç¼ºå°‘å­¦å·æˆ–å§“åï¼Œè·³è¿‡`);
                        skipCount++;
                        return;
                    }
                    
                    if (existingIds.has(studentId)) {
                        console.warn(`ç¬¬${index + 1}è¡Œï¼šå­¦å· ${studentId} å·²å­˜åœ¨ï¼Œè·³è¿‡`);
                        skipCount++;
                        return;
                    }
                    
                    const newStudent = {
                        id: ++maxId,
                        studentId: studentId,
                        name: name,
                        gender: item.æ€§åˆ« || item.gender || 'ç”·',
                        className: item.ç­çº§ || item.class || '',
                        major: item.ä¸“ä¸š || item.major || '',
                        college: item.å­¦é™¢ || item.college || '',
                        email: item.é‚®ç®± || item.email || '',
                        birthDate: item.å‡ºç”Ÿæ—¥æœŸ || item.birthDate || '',
                        enrollmentDate: item.å…¥å­¦æ—¥æœŸ || item.enrollmentDate || '',
                        hometown: item.ç±è´¯ || item.hometown || '',
                        ethnicity: item.æ°‘æ— || item.ethnicity || 'æ±‰æ—',
                        politicalStatus: item.æ”¿æ²»é¢è²Œ || item.politicalStatus || 'ç¾¤ä¼—',
                        status: item.çŠ¶æ€ || 'åœ¨è¯»',
                        createTime: new Date().toISOString()
                    };
                    
                    students.push(newStudent);
                    existingIds.add(studentId);
                    successCount++;
                    
                } catch (error) {
                    console.error(`ç¬¬${index + 1}è¡Œå¤„ç†å¤±è´¥ï¼š`, error);
                    errorCount++;
                }
            });
            
            saveStudents();
            alert(`å¯¼å…¥å®Œæˆï¼\næˆåŠŸï¼š${successCount}æ¡\nè·³è¿‡ï¼š${skipCount}æ¡\nå¤±è´¥ï¼š${errorCount}æ¡`);
            
            // æ¸…ç©ºé¢„è§ˆ
            clearImportPreview();
            showAllStudents();
        }
        
        // æ¸…ç©ºå¯¼å…¥é¢„è§ˆ
        function clearImportPreview() {
            document.getElementById('importPreview').innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“Š</div>
                    <div class="empty-text">è¯·ä¸Šä¼ Excelæ–‡ä»¶æŸ¥çœ‹æ•°æ®é¢„è§ˆ</div>
                </div>
            `;
            document.getElementById('importConfirmBtn').style.display = 'none';
            document.getElementById('excelFile').value = '';
            window.importData = null;
        }
        
        // æ›´æ–°å­¦ç”Ÿè¡¨æ ¼
        function updateStudentsTable() {
            const tableBody = document.getElementById('studentsTableBody');
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, filteredStudents.length);
            const currentStudents = filteredStudents.slice(startIndex, endIndex);
            
            if (currentStudents.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 50px;">
                            <div class="empty-state">
                                <div class="empty-icon">ğŸ‘¥</div>
                                <div class="empty-text">æš‚æ— å­¦ç”Ÿæ•°æ®</div>
                            </div>
                        </td>
                    </tr>
                `;
            } else {
                let html = '';
                currentStudents.forEach(student => {
                    const isSelected = selectedStudentIds.has(student.id);
                    html += `
                        <tr class="${isSelected ? 'selected' : ''}" id="student-row-${student.id}">
                            <td>
                                <input type="checkbox" class="select-all-checkbox" 
                                       ${isSelected ? 'checked' : ''}
                                       onchange="toggleStudentSelection(${student.id}, this)">
                            </td>
                            <td>${student.studentId}</td>
                            <td><strong>${student.name}</strong></td>
                            <td>${student.gender}</td>
                            <td>${student.className}</td>
                            <td>${student.major}</td>
                            <td>${student.college}</td>
                            <td>
                                <span class="status-badge ${student.status === 'åœ¨è¯»' ? 'status-active' : 'status-graduate'}">
                                    ${student.status}
                                </span>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn view" onclick="viewStudent(${student.id})">æŸ¥çœ‹</button>
                                    <button class="action-btn edit" onclick="editStudent(${student.id})">ç¼–è¾‘</button>
                                    <button class="action-btn delete" onclick="deleteStudent(${student.id})">åˆ é™¤</button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                tableBody.innerHTML = html;
            }
            
            // æ›´æ–°åˆ†é¡µä¿¡æ¯
            const totalPages = Math.ceil(filteredStudents.length / pageSize);
            document.getElementById('pageInfo').textContent = `ç¬¬ ${currentPage} é¡µ / å…± ${totalPages} é¡µ`;
            
            // æ›´æ–°é€‰ä¸­è®¡æ•°
            updateSelectedCount();
        }
        
        // åˆ‡æ¢å­¦ç”Ÿé€‰æ‹©
        function toggleStudentSelection(studentId, checkbox) {
            if (checkbox.checked) {
                selectedStudentIds.add(studentId);
            } else {
                selectedStudentIds.delete(studentId);
            }
            
            const row = document.getElementById(`student-row-${studentId}`);
            if (row) {
                row.classList.toggle('selected', checkbox.checked);
            }
            
            updateSelectedCount();
        }
        
        // å…¨é€‰å­¦ç”Ÿ
        function toggleSelectAllStudents(checkbox) {
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, filteredStudents.length);
            const currentStudents = filteredStudents.slice(startIndex, endIndex);
            
            const checkboxes = document.querySelectorAll('#studentsTableBody input[type="checkbox"]');
            
            if (checkbox.checked) {
                currentStudents.forEach(student => selectedStudentIds.add(student.id));
                checkboxes.forEach(cb => cb.checked = true);
            } else {
                currentStudents.forEach(student => selectedStudentIds.delete(student.id));
                checkboxes.forEach(cb => cb.checked = false);
            }
            
            // æ›´æ–°è¡Œæ ·å¼
            currentStudents.forEach(student => {
                const row = document.getElementById(`student-row-${student.id}`);
                if (row) {
                    row.classList.toggle('selected', checkbox.checked);
                }
            });
            
            updateSelectedCount();
        }
        
        // æ›´æ–°é€‰ä¸­è®¡æ•°
        function updateSelectedCount() {
            document.getElementById('selectedCount').textContent = selectedStudentIds.size;
        }
        
        // æœç´¢å­¦ç”Ÿ
        function searchStudents(keyword) {
            if (!keyword.trim()) {
                filteredStudents = [...students];
            } else {
                filteredStudents = students.filter(student => {
                    return Object.values(student).some(value => 
                        value && value.toString().toLowerCase().includes(keyword.toLowerCase())
                    );
                });
            }
            currentPage = 1;
            selectedStudentIds.clear();
            updateStudentsTable();
        }
        
        // ç¿»é¡µ
        function changePage(delta) {
            const totalPages = Math.ceil(filteredStudents.length / pageSize);
            const newPage = currentPage + delta;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                updateStudentsTable();
            }
        }
        
        // æ·»åŠ æ–°å­¦ç”Ÿ
        function addNewStudent(event) {
            event.preventDefault();
            
            const form = event.target;
            const studentId = document.getElementById('studentId').value;
            const name = document.getElementById('name').value;
            
            // æ£€æŸ¥å­¦å·æ˜¯å¦é‡å¤
            if (students.some(s => s.studentId === studentId)) {
                alert('å­¦å·å·²å­˜åœ¨ï¼Œè¯·ä½¿ç”¨ä¸åŒçš„å­¦å·ï¼');
                return;
            }
            
            // è·å–æœ€å¤§ID
            const maxId = students.length > 0 ? Math.max(...students.map(s => s.id)) : 0;
            
            const newStudent = {
                id: maxId + 1,
                studentId: studentId,
                name: name,
                gender: document.getElementById('gender').value,
                className: document.getElementById('className').value,
                major: document.getElementById('major').value,
                college: document.getElementById('college').value,
                email: document.getElementById('email').value,
                birthDate: document.getElementById('birthDate').value,
                enrollmentDate: document.getElementById('enrollmentDate').value,
                hometown: document.getElementById('hometown').value,
                ethnicity: document.getElementById('ethnicity').value,
                politicalStatus: document.getElementById('politicalStatus').value,
                status: document.getElementById('status').value,
                createTime: new Date().toISOString()
            };
            
            students.push(newStudent);
            saveStudents();
            form.reset();
            
            alert(`å­¦ç”Ÿ ${name} (${studentId}) æ·»åŠ æˆåŠŸï¼`);
            showAllStudents();
        }
        
        // æŸ¥çœ‹å­¦ç”Ÿè¯¦æƒ…
        function viewStudent(id) {
            const student = students.find(s => s.id === id);
            if (!student) return;
            
            const modalHtml = `
                <div class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <div class="modal-title">ğŸ‘¤ å­¦ç”Ÿè¯¦ç»†ä¿¡æ¯</div>
                            <button class="modal-close" onclick="closeModal()">Ã—</button>
                        </div>
                        <div class="modal-body">
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                                <div class="form-group">
                                    <label>å­¦å·</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px; font-weight: 500;">
                                        ${student.studentId}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>å§“å</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px; font-weight: 500;">
                                        ${student.name}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>æ€§åˆ«</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        ${student.gender}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>ç­çº§</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        ${student.className || 'æœªå¡«å†™'}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>ä¸“ä¸š</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        ${student.major || 'æœªå¡«å†™'}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>å­¦é™¢</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        ${student.college || 'æœªå¡«å†™'}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>é‚®ç®±</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        ${student.email || 'æœªå¡«å†™'}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>å‡ºç”Ÿæ—¥æœŸ</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        ${student.birthDate || 'æœªå¡«å†™'}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>å…¥å­¦æ—¥æœŸ</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        ${student.enrollmentDate || 'æœªå¡«å†™'}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>ç±è´¯</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        ${student.hometown || 'æœªå¡«å†™'}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>æ°‘æ—</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        ${student.ethnicity || 'æœªå¡«å†™'}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>æ”¿æ²»é¢è²Œ</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        ${student.politicalStatus || 'æœªå¡«å†™'}
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>çŠ¶æ€</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        <span class="status-badge ${student.status === 'åœ¨è¯»' ? 'status-active' : 'status-graduate'}">
                                            ${student.status}
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="form-group" style="grid-column: span 2;">
                                    <label>åˆ›å»ºæ—¶é—´</label>
                                    <div style="padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                        ${new Date(student.createTime).toLocaleString()}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeModal()">å…³é—­</button>
                            <button class="btn btn-primary" onclick="editStudent(${student.id}); closeModal()">
                                ç¼–è¾‘ä¿¡æ¯
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('modalContainer').innerHTML = modalHtml;
            document.querySelector('.modal').style.display = 'flex';
        }
        
        // ç¼–è¾‘å­¦ç”Ÿ
        function editStudent(id) {
            const student = students.find(s => s.id === id);
            if (!student) return;
            
            const modalHtml = `
                <div class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <div class="modal-title">âœï¸ ç¼–è¾‘å­¦ç”Ÿä¿¡æ¯</div>
                            <button class="modal-close" onclick="closeModal()">Ã—</button>
                        </div>
                        <div class="modal-body">
                            <form id="editStudentForm" onsubmit="updateStudent(event, ${student.id})">
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                                    <div class="form-group">
                                        <label for="editStudentId">å­¦å·</label>
                                        <input type="text" id="editStudentId" class="form-control" value="${student.studentId}" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editName">å§“å</label>
                                        <input type="text" id="editName" class="form-control" value="${student.name}" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editGender">æ€§åˆ«</label>
                                        <select id="editGender" class="form-control">
                                            <option value="ç”·" ${student.gender === 'ç”·' ? 'selected' : ''}>ç”·</option>
                                            <option value="å¥³" ${student.gender === 'å¥³' ? 'selected' : ''}>å¥³</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editClassName">ç­çº§</label>
                                        <input type="text" id="editClassName" class="form-control" value="${student.className || ''}">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editMajor">ä¸“ä¸š</label>
                                        <input type="text" id="editMajor" class="form-control" value="${student.major || ''}">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editCollege">å­¦é™¢</label>
                                        <input type="text" id="editCollege" class="form-control" value="${student.college || ''}">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editEmail">é‚®ç®±</label>
                                        <input type="email" id="editEmail" class="form-control" value="${student.email || ''}">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editBirthDate">å‡ºç”Ÿæ—¥æœŸ</label>
                                        <input type="date" id="editBirthDate" class="form-control" value="${student.birthDate || ''}">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editEnrollmentDate">å…¥å­¦æ—¥æœŸ</label>
                                        <input type="date" id="editEnrollmentDate" class="form-control" value="${student.enrollmentDate || ''}">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editHometown">ç±è´¯</label>
                                        <input type="text" id="editHometown" class="form-control" value="${student.hometown || ''}">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editEthnicity">æ°‘æ—</label>
                                        <input type="text" id="editEthnicity" class="form-control" value="${student.ethnicity || ''}">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editPoliticalStatus">æ”¿æ²»é¢è²Œ</label>
                                        <select id="editPoliticalStatus" class="form-control">
                                            <option value="">è¯·é€‰æ‹©</option>
                                            <option value="ç¾¤ä¼—" ${student.politicalStatus === 'ç¾¤ä¼—' ? 'selected' : ''}>ç¾¤ä¼—</option>
                                            <option value="å…±é’å›¢å‘˜" ${student.politicalStatus === 'å…±é’å›¢å‘˜' ? 'selected' : ''}>å…±é’å›¢å‘˜</option>
                                            <option value="ä¸­å…±å…šå‘˜" ${student.politicalStatus === 'ä¸­å…±å…šå‘˜' ? 'selected' : ''}>ä¸­å…±å…šå‘˜</option>
                                            <option value="å…¶ä»–" ${student.politicalStatus === 'å…¶ä»–' ? 'selected' : ''}>å…¶ä»–</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="editStatus">çŠ¶æ€</label>
                                        <select id="editStatus" class="form-control">
                                            <option value="åœ¨è¯»" ${student.status === 'åœ¨è¯»' ? 'selected' : ''}>åœ¨è¯»</option>
                                            <option value="ä¼‘å­¦" ${student.status === 'ä¼‘å­¦' ? 'selected' : ''}>ä¼‘å­¦</option>
                                            <option value="æ¯•ä¸š" ${student.status === 'æ¯•ä¸š' ? 'selected' : ''}>æ¯•ä¸š</option>
                                            <option value="é€€å­¦" ${student.status === 'é€€å­¦' ? 'selected' : ''}>é€€å­¦</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="modal-footer" style="margin-top: 30px; padding: 0;">
                                    <button type="button" class="btn btn-secondary" onclick="closeModal()">
                                        å–æ¶ˆ
                                    </button>
                                    <button type="submit" class="btn btn-primary">
                                        âœ… ä¿å­˜ä¿®æ”¹
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('modalContainer').innerHTML = modalHtml;
            document.querySelector('.modal').style.display = 'flex';
        }
        
        // æ›´æ–°å­¦ç”Ÿä¿¡æ¯
        function updateStudent(event, id) {
            event.preventDefault();
            
            const studentIndex = students.findIndex(s => s.id === id);
            if (studentIndex === -1) return;
            
            const newStudentId = document.getElementById('editStudentId').value;
            
            // æ£€æŸ¥å­¦å·æ˜¯å¦é‡å¤ï¼ˆæ’é™¤è‡ªå·±ï¼‰
            if (students.some((s, index) => index !== studentIndex && s.studentId === newStudentId)) {
                alert('å­¦å·å·²å­˜åœ¨ï¼Œè¯·ä½¿ç”¨ä¸åŒçš„å­¦å·ï¼');
                return;
            }
            
            students[studentIndex] = {
                ...students[studentIndex],
                studentId: newStudentId,
                name: document.getElementById('editName').value,
                gender: document.getElementById('editGender').value,
                className: document.getElementById('editClassName').value,
                major: document.getElementById('editMajor').value,
                college: document.getElementById('editCollege').value,
                email: document.getElementById('editEmail').value,
                birthDate: document.getElementById('editBirthDate').value,
                enrollmentDate: document.getElementById('editEnrollmentDate').value,
                hometown: document.getElementById('editHometown').value,
                ethnicity: document.getElementById('editEthnicity').value,
                politicalStatus: document.getElementById('editPoliticalStatus').value,
                status: document.getElementById('editStatus').value
            };
            
            saveStudents();
            updateStudentsTable();
            closeModal();
            alert('å­¦ç”Ÿä¿¡æ¯æ›´æ–°æˆåŠŸï¼');
        }
        
        // åˆ é™¤å•ä¸ªå­¦ç”Ÿ
        function deleteStudent(id) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå­¦ç”Ÿå—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) return;
            
            students = students.filter(s => s.id !== id);
            selectedStudentIds.delete(id);
            saveStudents();
            updateStudentsTable();
            alert('å­¦ç”Ÿåˆ é™¤æˆåŠŸï¼');
        }
        
        // åˆ é™¤é€‰ä¸­çš„å­¦ç”Ÿ
        function deleteSelectedStudents() {
            if (selectedStudentIds.size === 0) {
                alert('è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„å­¦ç”Ÿï¼');
                return;
            }
            
            if (!confirm(`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${selectedStudentIds.size} åå­¦ç”Ÿå—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼`)) {
                return;
            }
            
            students = students.filter(s => !selectedStudentIds.has(s.id));
            selectedStudentIds.clear();
            saveStudents();
            updateStudentsTable();
            alert(`æˆåŠŸåˆ é™¤ ${selectedStudentIds.size} åå­¦ç”Ÿï¼`);
        }
        
        // æ˜¾ç¤ºæ‰¹é‡åˆ é™¤
        function showBatchDelete() {
            selectedStudentIds.clear();
            showAllStudents();
            
            // æ»šåŠ¨åˆ°è¡¨æ ¼é¡¶éƒ¨
            document.querySelector('.content-area').scrollTop = 0;
            
            // æ˜¾ç¤ºæ‰¹é‡æ“ä½œæç¤º
            alert('è¯·åœ¨è¡¨æ ¼ä¸­é€‰æ‹©è¦åˆ é™¤çš„å­¦ç”Ÿï¼Œç„¶åç‚¹å‡»"åˆ é™¤é€‰ä¸­"æŒ‰é’®ã€‚');
        }
        
        // å¯¼å‡ºä¸ºExcel
        function exportToExcel() {
            if (students.length === 0) {
                alert('æ²¡æœ‰æ•°æ®å¯ä»¥å¯¼å‡ºï¼');
                return;
            }
            
            // å‡†å¤‡æ•°æ®
            const exportData = students.map(student => ({
                'å­¦å·': student.studentId,
                'å§“å': student.name,
                'æ€§åˆ«': student.gender,
                'ç­çº§': student.className,
                'ä¸“ä¸š': student.major,
                'å­¦é™¢': student.college,
                'é‚®ç®±': student.email,
                'å‡ºç”Ÿæ—¥æœŸ': student.birthDate,
                'å…¥å­¦æ—¥æœŸ': student.enrollmentDate,
                'ç±è´¯': student.hometown,
                'æ°‘æ—': student.ethnicity,
                'æ”¿æ²»é¢è²Œ': student.politicalStatus,
                'çŠ¶æ€': student.status
            }));
            
            // åˆ›å»ºå·¥ä½œè¡¨
            const worksheet = XLSX.utils.json_to_sheet(exportData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'å­¦ç”Ÿä¿¡æ¯');
            
            // ç”Ÿæˆæ–‡ä»¶å
            const fileName = `å­¦ç”Ÿä¿¡æ¯_${new Date().toISOString().slice(0,10)}.xlsx`;
            
            // å¯¼å‡ºæ–‡ä»¶
            XLSX.writeFile(workbook, fileName);
            alert(`æ•°æ®å·²æˆåŠŸå¯¼å‡ºä¸º ${fileName}`);
        }
        
        // æ˜¾ç¤ºå¯¼å‡ºåŒºåŸŸ
        function showExportSection() {
            if (students.length === 0) {
                alert('å½“å‰æ²¡æœ‰å­¦ç”Ÿæ•°æ®å¯ä»¥å¯¼å‡ºï¼');
                showImportSection();
                return;
            }
            
            exportToExcel();
        }
        
        // æ˜¾ç¤ºç»Ÿè®¡
        function showStatistics() {
            alert('ç»Ÿè®¡åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...');
        }
        
        // ç”¨æˆ·ç®¡ç†
        function manageUsers() {
            if (currentUser.role !== 'admin') {
                alert('åªæœ‰ç®¡ç†å‘˜å¯ä»¥è®¿é—®ç”¨æˆ·ç®¡ç†åŠŸèƒ½ï¼');
                return;
            }
            
            const modalHtml = `
                <div class="modal">
                    <div class="modal-content" style="max-width: 900px;">
                        <div class="modal-header">
                            <div class="modal-title">ğŸ‘¥ ç”¨æˆ·ç®¡ç†</div>
                            <button class="modal-close" onclick="closeModal()">Ã—</button>
                        </div>
                        <div class="modal-body">
                            <div style="margin-bottom: 20px;">
                                <button class="btn btn-primary" onclick="showAddUser()">
                                    â• æ·»åŠ ç”¨æˆ·
                                </button>
                            </div>
                            
                            <div style="overflow-x: auto;">
                                <table class="students-table">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>ç”¨æˆ·å</th>
                                            <th>çœŸå®å§“å</th>
                                            <th>é‚®ç®±</th>
                                            <th>è§’è‰²</th>
                                            <th>åˆ›å»ºæ—¶é—´</th>
                                            <th>æœ€åç™»å½•</th>
                                            <th>æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${users.map(user => `
                                            <tr>
                                                <td>${user.id}</td>
                                                <td>${user.username}</td>
                                                <td>${user.realName}</td>
                                                <td>${user.email}</td>
                                                <td>
                                                    <span class="status-badge ${user.role === 'admin' ? 'status-active' : 'status-graduate'}">
                                                        ${user.role === 'admin' ? 'ç®¡ç†å‘˜' : 'æ™®é€šç”¨æˆ·'}
                                                    </span>
                                                </td>
                                                <td>${new Date(user.createTime).toLocaleDateString()}</td>
                                                <td>${user.lastLogin ? new Date(user.lastLogin).toLocaleDateString() : 'ä»æœªç™»å½•'}</td>
                                                <td>
                                                    <div class="action-buttons">
                                                        ${user.id !== currentUser.id ? `
                                                            <button class="action-btn edit" onclick="editUser(${user.id})">ç¼–è¾‘</button>
                                                            <button class="action-btn delete" onclick="deleteUser(${user.id})">åˆ é™¤</button>
                                                        ` : '<span style="color: #7f8c8d; font-size: 12px;">å½“å‰ç”¨æˆ·</span>'}
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeModal()">å…³é—­</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('modalContainer').innerHTML = modalHtml;
            document.querySelector('.modal').style.display = 'flex';
        }
        
        // æ·»åŠ ç”¨æˆ·
        function showAddUser() {
            const modalHtml = `
                <div class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <div class="modal-title">â• æ·»åŠ ç”¨æˆ·</div>
                            <button class="modal-close" onclick="closeModal()">Ã—</button>
                        </div>
                        <div class="modal-body">
                            <form id="addUserForm" onsubmit="addNewUser(event)">
                                <div class="form-group">
                                    <label for="newUsername">ç”¨æˆ·å</label>
                                    <input type="text" id="newUsername" class="form-control" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="newPassword">å¯†ç </label>
                                    <input type="password" id="newPassword" class="form-control" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="newRealName">çœŸå®å§“å</label>
                                    <input type="text" id="newRealName" class="form-control" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="newEmail">ç”µå­é‚®ç®±</label>
                                    <input type="email" id="newEmail" class="form-control" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="newRole">è§’è‰²</label>
                                    <select id="newRole" class="form-control">
                                        <option value="user">æ™®é€šç”¨æˆ·</option>
                                        <option value="admin">ç®¡ç†å‘˜</option>
                                    </select>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                            <button class="btn btn-primary" onclick="addNewUser()">æ·»åŠ ç”¨æˆ·</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('modalContainer').innerHTML = modalHtml;
            document.querySelector('.modal').style.display = 'flex';
        }
        
        // æ·»åŠ æ–°ç”¨æˆ·
        function addNewUser(event) {
            if (event) event.preventDefault();
            
            const username = document.getElementById('newUsername').value.trim();
            const password = document.getElementById('newPassword').value.trim();
            const realName = document.getElementById('newRealName').value.trim();
            const email = document.getElementById('newEmail').value.trim();
            const role = document.getElementById('newRole').value;
            
            // éªŒè¯ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
            if (users.some(u => u.username === username)) {
                alert('ç”¨æˆ·åå·²å­˜åœ¨ï¼');
                return;
            }
            
            // éªŒè¯é‚®ç®±æ ¼å¼
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€ï¼');
                return;
            }
            
            // åˆ›å»ºæ–°ç”¨æˆ·
            const newUser = {
                id: users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1,
                username: username,
                password: password,
                realName: realName,
                email: email,
                role: role,
                createTime: new Date().toISOString(),
                lastLogin: null
            };
            
            users.push(newUser);
            saveUsers();
            closeModal();
            manageUsers();
            alert('ç”¨æˆ·æ·»åŠ æˆåŠŸï¼');
        }
        
        // ç¼–è¾‘ç”¨æˆ·
        function editUser(id) {
            const user = users.find(u => u.id === id);
            if (!user) return;
            
            const modalHtml = `
                <div class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <div class="modal-title">âœï¸ ç¼–è¾‘ç”¨æˆ·</div>
                            <button class="modal-close" onclick="closeModal()">Ã—</button>
                        </div>
                        <div class="modal-body">
                            <form id="editUserForm">
                                <div class="form-group">
                                    <label for="editUserUsername">ç”¨æˆ·å</label>
                                    <input type="text" id="editUserUsername" class="form-control" value="${user.username}" readonly>
                                </div>
                                
                                <div class="form-group">
                                    <label for="editUserRealName">çœŸå®å§“å</label>
                                    <input type="text" id="editUserRealName" class="form-control" value="${user.realName}" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="editUserEmail">ç”µå­é‚®ç®±</label>
                                    <input type="email" id="editUserEmail" class="form-control" value="${user.email}" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="editUserRole">è§’è‰²</label>
                                    <select id="editUserRole" class="form-control">
                                        <option value="user" ${user.role === 'user' ? 'selected' : ''}>æ™®é€šç”¨æˆ·</option>
                                        <option value="admin" ${user.role === 'admin' ? 'selected' : ''}>ç®¡ç†å‘˜</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="editUserPassword">é‡ç½®å¯†ç </label>
                                    <input type="password" id="editUserPassword" class="form-control" placeholder="ç•™ç©ºè¡¨ç¤ºä¸ä¿®æ”¹å¯†ç ">
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                            <button class="btn btn-primary" onclick="updateUser(${user.id})">ä¿å­˜ä¿®æ”¹</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('modalContainer').innerHTML = modalHtml;
            document.querySelector('.modal').style.display = 'flex';
        }
        
        // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
        function updateUser(id) {
            const userIndex = users.findIndex(u => u.id === id);
            if (userIndex === -1) return;
            
            const realName = document.getElementById('editUserRealName').value.trim();
            const email = document.getElementById('editUserEmail').value.trim();
            const role = document.getElementById('editUserRole').value;
            const newPassword = document.getElementById('editUserPassword').value.trim();
            
            // éªŒè¯é‚®ç®±æ ¼å¼
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€ï¼');
                return;
            }
            
            // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
            users[userIndex].realName = realName;
            users[userIndex].email = email;
            users[userIndex].role = role;
            
            // å¦‚æœè®¾ç½®äº†æ–°å¯†ç 
            if (newPassword) {
                users[userIndex].password = newPassword;
            }
            
            saveUsers();
            closeModal();
            manageUsers();
            alert('ç”¨æˆ·ä¿¡æ¯æ›´æ–°æˆåŠŸï¼');
        }
        
        // åˆ é™¤ç”¨æˆ·
        function deleteUser(id) {
            if (id === currentUser.id) {
                alert('ä¸èƒ½åˆ é™¤å½“å‰ç™»å½•çš„ç”¨æˆ·ï¼');
                return;
            }
            
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç”¨æˆ·å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                return;
            }
            
            users = users.filter(u => u.id !== id);
            saveUsers();
            manageUsers();
            alert('ç”¨æˆ·åˆ é™¤æˆåŠŸï¼');
        }
        
        // å¤‡ä»½æ•°æ®
        function backupData() {
            const backupData = {
                students: students,
                users: users.filter(u => u.id !== currentUser.id), // ä¸åŒ…å«å½“å‰ç”¨æˆ·å¯†ç 
                timestamp: new Date().toISOString(),
                backupUser: currentUser.username
            };
            
            const dataStr = JSON.stringify(backupData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `å­¦ç”Ÿç³»ç»Ÿå¤‡ä»½_${new Date().toISOString().slice(0,19).replace(/:/g,'-')}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            alert('æ•°æ®å¤‡ä»½æˆåŠŸï¼');
        }
        
        // æ¢å¤æ•°æ®
        function restoreData() {
            if (!confirm('âš ï¸ è­¦å‘Šï¼šæ¢å¤æ•°æ®å°†è¦†ç›–å½“å‰æ‰€æœ‰å­¦ç”Ÿæ•°æ®ï¼æ˜¯å¦ç»§ç»­ï¼Ÿ')) {
                return;
            }
            
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const restoredData = JSON.parse(e.target.result);
                        
                        if (!restoredData.students || !Array.isArray(restoredData.students)) {
                            throw new Error('å¤‡ä»½æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®');
                        }
                        
                        // æ¢å¤å­¦ç”Ÿæ•°æ®
                        students = restoredData.students;
                        saveStudents();
                        
                        alert(`æ•°æ®æ¢å¤æˆåŠŸï¼æ¢å¤äº† ${students.length} æ¡å­¦ç”Ÿè®°å½•ã€‚`);
                        showAllStudents();
                    } catch (error) {
                        alert('æ•°æ®æ¢å¤å¤±è´¥ï¼š' + error.message);
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // æ¸…ç©ºæ‰€æœ‰æ•°æ®
        function clearAllData() {
            if (students.length === 0) {
                alert('å½“å‰æ²¡æœ‰å­¦ç”Ÿæ•°æ®ï¼');
                return;
            }
            
            if (!confirm(`âš ï¸ ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰ ${students.length} åå­¦ç”Ÿæ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`)) {
                return;
            }
            
            students = [];
            selectedStudentIds.clear();
            filteredStudents = [];
            saveStudents();
            updateStudentsTable();
            alert('æ‰€æœ‰å­¦ç”Ÿæ•°æ®å·²æ¸…ç©ºï¼');
        }
        
        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            const modal = document.querySelector('.modal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        // æœç´¢åŒºåŸŸ
        function showSearchSection() {
            // æ»šåŠ¨åˆ°æœç´¢æ¡†å¹¶èšç„¦
            showAllStudents();
            setTimeout(() => {
                document.getElementById('searchInput').focus();
            }, 100);
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = initSystem;
    </script>
</body>
</html>
